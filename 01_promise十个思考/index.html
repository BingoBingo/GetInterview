<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>promise测试</title>
</head>
<body>
    <script>
        // 1.
        /*
        const promise = new Promise((resovle, reject) => {
            console.log(1);
            resovle();
            console.log(2);
        });
        promise.then(() => {
            console.log(3);
        });
        console.log(4);*/

        // 2.
        /*
        const promise1 = new Promise((resolve, reject) => {
            setTimeout(() => {
                resolve('success')
            }, 1000);
        })
        const promise2 = promise1.then(() => {
            throw new Error('error!!!');
        })

        console.log('promise1cc', promise1)
        console.log('promise2cc', promise2)

        setTimeout(() => {
        console.log('promise1', promise1)
        console.log('promise2', promise2)
        }, 2000)*/

        // 3. then:  success1
        /*
        const promise = new Promise((resolve, reject) => {
            resolve('success1');
            reject('error');
            resolve('success2');
        })

        promise
        .then((res) => {
            console.log('then: ', res);
        })
        .catch((err) => {
            console.log('catch: ', err);
        })*/

        // 4. 1, 2
        /*
        Promise.resolve(1)
        .then((res) => {
            console.log(res)
            return 2
        })
        .catch((err) => {
            return 3
        })
        .then((res) => {
            console.log(res)
        })*/

       
        // 5.
        /*
        const promise = new Promise((resolve, reject) => {
            setTimeout(() => {
                console.log('once');
                resolve('success');
            }, 1000);
        })

        const start = Date.now();
        promise.then((res) => {
            console.log(res, Date.now() - start)
        })
        promise.then((res) => {
            console.log(res, Date.now() - start)
        })*/


        // 6.
        /*
        Promise.resolve()
        .then(() => {
            return new Error('error!!!')
        })
        .then((res) => {
            console.log('then: ', res)
        })
        .catch((err) => {
            console.log('catch: ', err)
        })*/


        // 7.
        /*
        const promise = Promise.resolve()
        .then(() => {
            return promise;
        })
        promise.catch(console.error);*/

        // 8. .then 或者 .catch 的参数期望是函数，传入非函数则会发生值穿透。
        /*
        Promise.resolve(1)
        .then(2)
        .then(Promise.resolve(3))
        .then(console.log)*/

        // 9.
        /*
        Promise.resolve()
        .then(function success (res) {
            throw new Error('error')
        }, function fail1 (e) {
            console.error('fail1: ', e)
        })
        .catch(function fail2 (e) {
            console.error('fail2: ', e)
        })*/

        // 10.
        process.nextTick(() => {
            console.log('nextTick')
        })
        Promise.resolve()
        .then(() => {
            console.log('then')
        })
        setImmediate(() => {
            console.log('setImmediate')
        })
        console.log('end')

    </script>
</body>
</html>